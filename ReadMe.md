## lapsolver
A fast Linear Assignment Problem solver using Hungarian Algorithm, also known as Kuhn–Munkres algorithm or Munkres assignment algorithm. 
One big advantage comparing with scipy.optimize.linear_sum_assignment is that it supports Non-allowed pairings (NaN values in cost matrix).

### Install

```
pip install lapsolver 
```
#### Problem
**lapsolver** installation error: required CMake for build, the lates version has OpenMP supporting, however the OpenMP finding in CMakeLists doesn’t work and causes the installation failure on MacOS. 
#### Solution
1. Comment
```
# find_package(OpenMP)
# target_compile_options(lapsolverc PUBLIC "$<$<CONFIG:RELEASE>:${OpenMP_CXX_FLAGS}>")
```
Then, **install from source**  

OR  

2. Install the previous release
```
Pip install lapsolver==1.0.0.dev60
```

### Install from source

Clone this repository 

```
git clone --recursive https://github.com/cheind/py-lapsolver.git
``` 

Then build the project and exectute tests

```
python setup.py develop
python setup.py test
```

Executing the tests requires `pytest` and optionally `pytest-benchmark` for generating benchmarks.

### Usage

```python
import numpy as np
from lapsolver import solve_dense

cost = np.array([[1, 2, 3], [1, 1, 1], [3, 3, 3]])

row_ind, col_ind = solve_dense(cost)  #return row and column indice of assignments
row_ind
array([0, 1, 2], dtype=int32)
col_ind
array([0, 1, 2], dtype=int32)
```

Non-allowed pairings

```python
cost = np.array([[1, 2, 3], 
                 [1, 1, 1], 
                 [np.nan, np.nan, np.nan], 
                 [3, 3, 3]])

row_ind, col_ind = solve_dense(cost)

row_ind
array([0, 1, 3], dtype=int32)
col_ind
array([0, 1, 2], dtype=int32)
```

### Benchmarks

Comparisons below are generated by scripts in [`./lapsolver/benchmarks`](./lapsolver/benchmarks). 

Currently, the following solvers are tested
 - `lapjv` - https://github.com/gatagat/lap
 - `munkres` - http://software.clapper.org/munkres/
 - `ortools` - https://github.com/google/or-tools **
 - `scipy` - https://github.com/scipy/scipy/tree/master/scipy
 - `lapsolver` - this project

**reduced performance due to costly dense matrix to graph conversion. If you know a better way, please let me know.

Please note that the x-axis is scaled logarithmically. Missing bars indicate excessive runtime or errors in returned result.
![](./lapsolver/etc/benchmark-dtype-int.png)
![](./lapsolver/etc/benchmark-dtype-numpy.float32.png)
